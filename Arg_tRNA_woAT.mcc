//==============================
// MC-Sym 4.2 script generated by Wei Huang 09/06/2023
// Parisien M, Major F. Nature. (2008) 452:51-55.
//
// web site FAQ: www.major.iric.ca/MC-Sym/faq.html
//
// mcsym -v -D ./MCSYM-DB  Arg_tRNA_woAT.mcc


//========== Sequence ==========

sequence( r A1  GGCUCUGUGGCGCAAUGGAUAGCGCAUUGGACUUCUAAUUCAAAGGUUGUGGGUUCGAAUCCCACCAGAGUC )
//              (((((((..((((........)))).(((((.......))))).....(((((.......))))))))))))
//              DDDDDDD  AAAAAAAAAAAAAAAA BBBBBBBBBBBBBBBBB     CCCCCCCCCCCCCCCCCDDDDDDD
//                       1         2         3         4         5         6         7  
//              1234567890123456789012345678901234567890123456789012345678901234567890123456
//
//  http://www.major.iric.ca/MC-Sym/Work/MEZ5X7OSDn/



//========== Relations ==========
//relation(

  // anticodon's loop special conformation
  // Fuller W, Hodgson A.
  //  Conformation of the anticodon loop in tRNA.
  //  Nature. 1967 215:817-21.
  //A31:A32 { adjacent_5p && !stack } 100
  //A32:A36 { file( "helixA_RNA" ) stack } 1
  // 3'-RCCA
//)

implicit_relation(

 A8 A15 { pairing }
 A18 A55 { pairing }
 A19 A56 { pairing }
 //A26 A44 { pairing }
 A54 A58 { pairing }

)



//========== Library ==========


//---------- D stem/loop ----------
ncm_02 = library(
	pdb( "MCSYM-DB/2_2/GCGC/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A12:A13, A22:A23
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_03 = library(
	pdb( "MCSYM-DB/2_2/CGCG/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A11:A12, A23:A24
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_04 = library(
	pdb( "MCSYM-DB/2_2/GCGC/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A10:A11, A24:A25
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )


//---------- anticodon ----------
ncm_07 = library(
	pdb( "MCSYM-DB/2_2/GAUU/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A30:A31, A39:A40
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_08 = library(
	pdb( "MCSYM-DB/2_2/GGUC/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A29:A30, A40:A41
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_09 = library(
	pdb( "MCSYM-DB/2_2/UGCA/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A28:A29, A41:A42
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_10 = library(
	pdb( "MCSYM-DB/2_2/UUAA/*_1.pdb.gz" ) #1:#2, #3:#4 <- A27:A28, A42:A43
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )


//---------- T stem/loop ----------
ncm_13 = library(
	pdb( "MCSYM-DB/2_2/GGCC/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A52:A53, A61:A62
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_14 = library(
	pdb( "MCSYM-DB/2_2/GGCC/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A51:A52, A62:A63
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_15 = library(
	pdb( "MCSYM-DB/2_2/UGCA/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A50:A51, A63:A64
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_16 = library(
	pdb( "MCSYM-DB/2_2/GUAC/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A49:A50, A64:A65
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )


//---------- acceptor ----------
ncm_17 = library(
	pdb( "MCSYM-DB/2_2/UGCA/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A6:A7, A66:A67
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_18 = library(
	pdb( "MCSYM-DB/2_2/CUAG/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A5:A6, A67:A68
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_19 = library(
	pdb( "MCSYM-DB/2_2/UCGA/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A4:A5, A68:A69
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_20 = library(
	pdb( "MCSYM-DB/2_2/CUAG/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A3:A4, A69:A70
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_21 = library(
	pdb( "MCSYM-DB/2_2/GCGU/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A2:A3, A70:A71
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
ncm_22 = library(
	pdb( "MCSYM-DB/2_2/GGUC/*R20*.pdb.gz" ) #1:#2, #3:#4 <- A1:A2, A71:A72
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )


//---------- single-stranded ----------
loop_D0 = library(
        pdb( "MCSYM-DB/ss3/CAA/*.pdb.gz" ) #1:#3 <- A13:A15
        rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
loop_D1 = library(
        pdb( "MCSYM-DB/ss3/AUG/*.pdb.gz" ) #1:#3 <- A15:A17
        rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
loop_D2 = library(
	pdb( "MCSYM-DB/ss4/GGAU/*.pdb.gz" ) #1:#4 <- A17:A20
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
loop_D3 = library(
        pdb( "MCSYM-DB/ss3/UAG/*.pdb.gz" ) #1:#3 <- A20:A22
        rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )

loop_AT0 = library(
        pdb( "MCSYM-DB/ss2/AC/*.pdb.gz" ) #1:#2 <- A31:A32
        rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
loop_AT1 = library(
        pdb( "MCSYM-DB/ss4/CUUC/*.pdb.gz" ) #1:#4 <- A32:A35
        rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
loop_AT2 = library(
        pdb( "MCSYM-DB/ss4/CUAA/*.pdb.gz" ) #1:#4 <- A35:A38
        rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
loop_AT3 = library(
        pdb( "MCSYM-DB/ss2/AU/*.pdb.gz" ) #1:#2 <- A38:A39
        rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )

lnk_D_Acc = library(
	pdb( "MCSYM-DB/ss4/GUGG/*.pdb.gz" ) #1:#4 <- A7:A10
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )

lnk_Xtra1 = library(
	pdb( "MCSYM-DB/ss4/AAGG/*.pdb.gz" ) #1:#4 <- A43:A46
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )
lnk_Xtra2 = library(
	pdb( "MCSYM-DB/ss4/GUUG/*.pdb.gz" ) #1:#4 <- A46:A49
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )

stk_D_Ant = library(
	pdb( "MCSYM-DB/ss3/CAU/*.pdb.gz" ) #1:#3 <- A25:A27
	rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )

stk_A = library(
        pdb( "MCSYM-DB/ss2/CC/*.pdb.gz" ) #1:#2 <- A65:A66
        rmsd( 0.1 sidechain && !( pse || lp || hydrogen ) ) )

//=========== Backtrack ===========
// assemble the whole structure:

structure = backtrack(

	// <<<<<--------------------
	// build the clover-leaf first

	//----- anticodon -----
	ncm_10
	merge( ncm_09    1.5 )

	//----- D stem/loop -----
	merge( stk_D_Ant 1.5 )
	merge( ncm_04    1.5 )
	merge( ncm_03    1.5 )

	//----- acceptor -----
	merge( lnk_D_Acc 1.5 )
	merge( ncm_17    1.5 )
	merge( ncm_18    1.5 )
	merge( stk_A	 1.5 )
	
	//----- T stem/loop -----
	merge( ncm_16    1.5 )
	merge( ncm_15    1.5 )
	merge( ncm_14    1.5 )
	merge( ncm_13    1.5 )

	//----- D stem/loop -----
	// force it to build around T stem/loop
	merge( ncm_02    1.5 )
	merge( loop_D3	 1.5 )
	merge( loop_D2   1.5 )
	merge( loop_D1   1.5 )
	merge( loop_D0   1.5 )

	//----- extra loop -----
	merge( lnk_Xtra2 1.5 )
	merge( lnk_Xtra1 1.5 )

	//----- anticodon -----
	merge( ncm_08    1.5 )
	merge( ncm_07    1.5 )
//	merge( loop_AT0  1.5 )
//	merge( loop_AT1   1.5 )
//      merge( loop_AT2   1.5 )
//	merge( loop_AT3	  1.5 )

	//----- acceptor -----
	merge( ncm_19    1.5 )
	merge( ncm_20    1.5 )
	merge( ncm_21    1.5 )
	merge( ncm_22    1.5 )

	// -------------------->>>>>
)



// ========= Distance Restraints =========
// Levitt M.
//  Detailed model for transfer ribonucleic acid.
//  Nature. 1969 224:759-63.
// coax stack between D and anticodon
//distance( A25:PSY  A26:PSY  0.0  5.0 )
// coax stack between T and acceptor
distance( A65:PSY  A66:PSY  0.0  5.0 )



// ========= Backtrack / Restraints =========

clash        ( structure 1.5 !( pse || lp || hydrogen ) )

backtrack_rst( structure
               width_limit = 25%, height_limit = 100%,
               method = probabilistic )



// ========= Ribose / Restraints =========

ribose_rst   ( structure
               method = ccm,
	       //method = estimate,
               threshold = 1.5 )



// ========= Exploration Initialization =========
explore(
	structure
	option( model_limit = 9999, seed = 3210 )
	rmsd( 1.0 sidechain && !( pse || lp || hydrogen ) )
	pdb( "tRNA_arg" zipped )
)
